This is a natural graph problem and I resorted to NetworkX
